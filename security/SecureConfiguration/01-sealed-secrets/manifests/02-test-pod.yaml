# Secret을 사용하는 테스트 Pod
apiVersion: v1
kind: Pod
metadata:
  name: secret-test-pod
  namespace: sealed-secrets-test
spec:
  restartPolicy: Never
  containers:
    - name: test
      image: busybox:1.36
      command: ["sh", "-c"]
      args:
        - |
          echo "=== Secret 값 확인 ==="
          echo "Username: $DB_USERNAME"
          echo "Password length: ${#DB_PASSWORD}"
          echo "Connection string exists: $([ -n \"$CONNECTION_STRING\" ] && echo 'yes' || echo 'no')"
          echo "=== 테스트 완료 ==="
          sleep 10
      env:
        - name: DB_USERNAME
          valueFrom:
            secretKeyRef:
              name: db-credentials
              key: username
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              name: db-credentials
              key: password
        - name: CONNECTION_STRING
          valueFrom:
            secretKeyRef:
              name: db-credentials
              key: connection_string
