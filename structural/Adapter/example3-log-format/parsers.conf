# Parser configuration for different log formats

# Apache Common Log Format
# 127.0.0.1 - - [10/Oct/2000:13:55:36 -0700] "GET /api/data HTTP/1.0" 200 2326
[PARSER]
    Name        apache
    Format      regex
    Regex       ^(?<host>[^ ]*) [^ ]* (?<user>[^ ]*) \[(?<time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^\"]*?)(?: +\S*)?)?" (?<status>[^ ]*) (?<size>[^ ]*)$
    Time_Key    time
    Time_Format %d/%b/%Y:%H:%M:%S %z
    Types       status:integer size:integer

# Custom Application Format
# [2024-01-15 10:30:45] INFO: Request processed | status=200 | duration=45ms
[PARSER]
    Name        custom
    Format      regex
    Regex       ^\[(?<time>[^\]]+)\] (?<level>\w+): (?<message>[^|]+) \| status=(?<status>\d+) \| duration=(?<duration>[\d.]+)ms$
    Time_Key    time
    Time_Format %Y-%m-%d %H:%M:%S
    Types       status:integer duration:float

# Syslog-like Format
# Jan 15 10:30:45 hostname app[12345]: Request status=200 duration=45ms
[PARSER]
    Name        syslog
    Format      regex
    Regex       ^(?<time>[^ ]* [^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? (?<message>.*)$
    Time_Key    time
    Time_Format %b %d %H:%M:%S
    Time_Keep   On

# Syslog message parser (nested)
[PARSER]
    Name        syslog_message
    Format      regex
    Regex       ^Request status=(?<status>\d+) duration=(?<duration>[\d.]+)ms$
    Types       status:integer duration:float

# CSV Format
# timestamp,level,status,duration_ms
[PARSER]
    Name        csv
    Format      regex
    Regex       ^(?<time>[^,]+),(?<level>[^,]+),(?<status>[^,]+),(?<duration>[^,\n]+)$
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S
    Types       status:integer duration:float

# Skip comment lines
[PARSER]
    Name        skip_comments
    Format      regex
    Regex       ^#.*$
