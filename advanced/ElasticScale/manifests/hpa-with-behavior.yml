# HPA with Behavior — 스케일업/다운 정책을 세밀하게 제어
# 스케일업은 빠르게, 스케일다운은 보수적으로 (프로덕션 권장 패턴)
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: random-generator-with-behavior
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: random-generator
  minReplicas: 1
  maxReplicas: 10
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 50
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 0       # 스케일업은 즉시 반응
      policies:
      - type: Percent
        value: 100           # 현재 레플리카의 100%까지 한번에 증가 가능
        periodSeconds: 15
    scaleDown:
      stabilizationWindowSeconds: 300     # 5분간 안정화 기간 (Flapping 방지)
      policies:
      - type: Percent
        value: 10            # 60초마다 현재 레플리카의 최대 10%만 감소
        periodSeconds: 60
